<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calcula tu Elemento</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&family=Lilita+One&family=Pacifico&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            transition: background-color 0.8s ease;
        }

        .screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 1.5rem;
            transition: opacity 0.5s ease-in-out;
        }

        #calculator-screen {
            background: linear-gradient(135deg, #fde68a, #fca5a5, #86efac, #93c5fd);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
        }
        
        #result-screen {
             background: none; /* El color se aplicará desde JS */
             position: relative;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        .main-container, .result-container {
            width: 100%;
            max-width: 32rem; /* max-w-lg */
            text-align: center;
        }
        
        .result-container {
             max-width: 56rem; /* max-w-2xl */
        }

        .title-discover {
            font-family: 'Pacifico', cursive;
            color: #14532d;
            font-size: 2.5rem;
            line-height: 1;
        }

        .title-element {
            font-family: 'Lilita One', sans-serif;
            color: #ec4899;
            font-size: 3.75rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            line-height: 1.1;
        }

        .card {
            background-color: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 2rem;
            border-radius: 0.75rem;
            box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            width: 100%;
            margin-top: 1.5rem;
        }
        .input-field {
            border: 1px solid #d1d5db;
            border-radius: 0.375rem;
            padding: 0.5rem 0.75rem;
            width: 100%;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
        }
        .btn {
            background-color: #3b82f6;
            color: white;
            font-weight: 600;
            padding: 0.5rem 1.5rem;
            border-radius: 0.375rem;
            box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: auto;
        }
        .btn:hover {
            background-color: #2563eb;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        .error-text {
            font-size: 0.875rem;
            margin-top: 0.5rem;
            color: #ef4444; 
        }

        .footer-text {
            margin-top: 1.5rem;
            font-size: 0.875rem;
            color: rgba(31, 41, 55, 0.8);
            text-shadow: 1px 1px 2px rgba(255,255,255,0.2);
            padding: 0 1rem;
        }
        
        /* Estilos de la pantalla de resultado */
        .result-content {
            color: white;
            font-size: 1.125rem;
            line-height: 1.75;
            text-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        .result-title-container {
            position: relative;
            display: inline-block;
        }
        .result-title-discover {
            font-family: 'Pacifico', cursive;
            font-size: 3rem;
            color: rgba(255,255,255,0.8);
            position: absolute;
            top: -0.5rem;
            left: -1rem;
            transform: translateX(-25%);
        }
        .result-title-element {
            font-family: 'Lilita One', sans-serif;
            font-size: 6rem;
            color: #fe95f6;
            text-transform: uppercase;
            line-height: 1;
        }
        .newsletter-form {
            background-color: white;
            border-radius: 0.375rem;
            padding: 0.25rem;
            display: flex;
            max-width: 350px;
            margin: 2rem auto 0 auto;
        }
        .newsletter-input {
            border: none;
            outline: none;
            padding: 0.5rem 0.75rem;
            flex-grow: 1;
            color: #374151;
        }
        .newsletter-button {
            background-color: #a32ca3;
            color: white;
            border: none;
            border-radius: 0.25rem;
            padding: 0.5rem 1rem;
            font-weight: 600;
            cursor: pointer;
        }
        
        #backButton {
            position: fixed;
            bottom: 20px;
            left: 20px;
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 10px 20px;
            border-radius: 50px;
            text-decoration: none;
            font-family: sans-serif;
            font-size: 14px;
            transition: background-color 0.3s;
            z-index: 10;
        }
         #backButton:hover {
            background-color: rgba(0, 0, 0, 0.7);
        }
        .copyright {
            position: fixed;
            bottom: 1rem;
            right: 1.5rem;
            font-size: 0.75rem;
            color: rgba(255, 255, 255, 0.7);
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }
        .social-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: opacity 0.2s;
            text-decoration: none;
        }
        .social-link:hover {
            opacity: 0.8;
        }
        .social-icon {
            transition: transform 0.2s;
        }
        .social-icon:hover {
            transform: scale(1.1);
        }
       
        .calculation-counter {
            margin-top: 0.5rem;
            font-size: 0.75rem;
        }
    </style>
</head>
<body>

    <!-- Pantalla 1: Calculadora -->
    <div id="calculator-screen" class="screen">
        <div class="main-container">
            <header>
                <h1 class="title-discover">Descubre</h1>
                <h2 class="title-element">Tu Elemento</h2>
            </header>

            <section class="card">
                <div class="space-y-4 text-left">
                    <label for="birthDate" class="block text-sm font-medium text-slate-700">Fecha de Nacimiento:</label>
                    <input type="date" id="birthDate" name="birthDate" class="input-field" placeholder="dd/mm/aaaa">
                    <div class="pt-2">
                         <button id="calculateDayMaster" class="btn">Calcular</button>
                    </div>
                    <div id="dayMasterError" class="error-text text-center"></div>
                </div>
            </section>
            
            <footer class="footer-text">
                <p>Esta calculadora es solamente para identificar el elemento del Día Maestro.<br>Para análisis más profundo. Escríbenos.</p>
                <p id="run-counter" class="calculation-counter">Cálculos realizados: <span>...</span></p>
                <div class="mt-4 flex flex-col items-center gap-4 text-xs">
                     <a href="https://w.app/v9rd8l" target="_blank" rel="noopener noreferrer" class="social-link font-semibold text-gray-700">
                        <svg class="social-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="black"><path d="M12.04 2c-5.46 0-9.9 4.44-9.9 9.9 0 1.74.45 3.48 1.34 5.02l-1.38 5.02 5.14-1.35c1.47.81 3.12 1.23 4.8 1.23h.01c5.46 0 9.9-4.44 9.9-9.9s-4.44-9.9-9.9-9.9zM17.23 14.25c-.21-.11-1.25-.62-1.44-.69-.2-.07-.34-.11-.49.11-.15.22-.54.69-.67.83s-.25.16-.47.05c-.22-.11-.9-.33-1.71-1.05-.63-.56-1.05-1.25-1.17-1.47-.12-.22-.01-.34.1-.45.1-.1.22-.26.34-.39s.16-.22.24-.37.04-.28-.01-.39c-.05-.11-.47-1.13-.64-1.54s-.34-.35-.47-.36c-.13 0-.28-.01-.43-.01s-.38.05-.58.28c-.2.22-.78.76-.78 1.85s.8 2.15 1.03 2.44c.06.07 1.49 2.26 3.63 3.18.51.21.91.34 1.22.44.47.16 1.03.14 1.35.04.38-.09 1.25-.51 1.42-.99.18-.48.18-.88.13-.99s-.15-.15-.34-.25z"></path></svg>
                        <span>ASESORIA PERSONALIZADA CON MARCY</span>
                    </a>
                    <div class="flex items-center gap-2">
                        <span>Copyright 2025 - Marcy Bing. All rights reserved.</span>
                        <a href="https://www.instagram.com/marcy.bing/" target="_blank" rel="noopener noreferrer" class="social-icon">
                           <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="black" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>
                        </a>
                    </div>
                </div>
            </footer>
        </div>
    </div>

    <!-- Pantalla 2: Resultado (Oculta por defecto) -->
    <div id="result-screen" class="screen hidden">
        <div id="result-content-container" class="result-container grid grid-cols-1 md:grid-cols-2 gap-8 items-center">
            <!-- Columna de Título -->
            <div class="flex flex-col items-center justify-center md:items-end md:justify-end md:pr-8">
                <div class="result-title-container">
                    <h2 class="result-title-discover">eres</h2>
                    <h1 id="result-title-element" class="result-title-element"></h1>
                </div>
                <div class="flex flex-col items-center md:items-end gap-4 mt-4">
                    <a href="https://w.app/v9rd8l" target="_blank" rel="noopener noreferrer" class="social-link text-white font-semibold text-sm">
                        <svg class="social-icon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="white"><path d="M12.04 2c-5.46 0-9.9 4.44-9.9 9.9 0 1.74.45 3.48 1.34 5.02l-1.38 5.02 5.14-1.35c1.47.81 3.12 1.23 4.8 1.23h.01c5.46 0 9.9-4.44 9.9-9.9s-4.44-9.9-9.9-9.9zM17.23 14.25c-.21-.11-1.25-.62-1.44-.69-.2-.07-.34-.11-.49.11-.15.22-.54.69-.67.83s-.25.16-.47.05c-.22-.11-.9-.33-1.71-1.05-.63-.56-1.05-1.25-1.17-1.47-.12-.22-.01-.34.1-.45.1-.1.22-.26.34-.39s.16-.22.24-.37.04-.28-.01-.39c-.05-.11-.47-1.13-.64-1.54s-.34-.35-.47-.36c-.13 0-.28-.01-.43-.01s-.38.05-.58.28c-.2.22-.78.76-.78 1.85s.8 2.15 1.03 2.44c.06.07 1.49 2.26 3.63 3.18.51.21.91.34 1.22.44.47.16 1.03.14 1.35.04.38-.09 1.25-.51 1.42-.99.18-.48.18-.88.13-.99s-.15-.15-.34-.25z"></path></svg>
                        <span>ASESORIA PERSONALIZADA CON MARCY</span>
                    </a>
                    <a href="https://www.instagram.com/marcy.bing/" target="_blank" rel="noopener noreferrer" class="social-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.51" y2="6.5"></line></svg>
                    </a>
                </div>
            </div>
            <!-- Columna de Contenido -->
            <div class="result-content space-y-6 text-center md:text-left">
                <p id="result-description"></p>
                <p id="result-question"></p>
                
                <div class="newsletter-section max-w-sm mx-auto md:mx-0">
                    <form id="newsletter-form" class="newsletter-form">
                        <input type="email" id="newsletter-email" placeholder="Enter your email" class="newsletter-input" required>
                        <button type="submit" class="newsletter-button">Suscríbete</button>
                    </form>
                    <p id="newsletter-feedback" class="text-sm mt-2 h-4"></p>
                    <p class="text-sm font-semibold mt-2">¡Sácale ventaja creativa al drama elemental!</p>
                </div>
                 <p id="result-footer-note" class="text-xs opacity-80 mt-4"></p>
            </div>
        </div>
        <a href="#" id="backButton">← Calcular de Nuevo</a>
        <div id="copyright-result" class="copyright">
            <span id="copyright-text"></span>
        </div>
    </div>

    <script type="module">
        // Importar funciones de Firebase
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, doc, getDoc, setDoc, increment, serverTimestamp, setLogLevel, collection, query, where, getDocs, addDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // --- Configuración de Firebase ---
        // ¡¡¡ PASO CRUCIAL !!!
        // REEMPLAZA ESTE BLOQUE 'firebaseConfig' CON TU PROPIO OBJETO DE CONFIGURACIÓN.
        // Lo encuentras en tu proyecto de Firebase:
        // Engranaje (Configuración del proyecto) > Tus apps > SDK de Firebase > Configuración (CDN)
        const firebaseConfig = {
            apiKey: "AIzaSyBgT8Aib-XdZu1aWvBPCzZcn0ra9tsUQxc",
            authDomain: "calculadora-elemental.firebaseapp.com",
            projectId: "calculadora-elemental",
            storageBucket: "calculadora-elemental.appspot.com",
            messagingSenderId: "582802877245",
            appId: "1:582802877245:web:ea8248c42a8d2c73beb354"
        };
        
        const appId = "calculadora-bazi"; 

        // --- Inicialización de Firebase ---
        let db;
        let isFirebaseReady = false;

        try {
            const app = initializeApp(firebaseConfig);
            db = getFirestore(app);
            const auth = getAuth(app);
            setLogLevel('debug'); 
            await signInAnonymously(auth);
            console.log("Autenticación con Firebase exitosa.");
            isFirebaseReady = true;
        } catch (error) {
            console.error("Error al inicializar Firebase:", error);
            const errorDiv = document.getElementById('dayMasterError');
            if (errorDiv) {
                if (error.code === 'auth/admin-restricted-operation' || error.code === 'auth/operation-not-allowed') {
                     errorDiv.textContent = "Error: Habilita el Acceso Anónimo en tu panel de Firebase (Authentication > Sign-in method).";
                } else {
                     errorDiv.textContent = "El contador y suscripción no están disponibles ahora.";
                }
            }
            const runCounter = document.getElementById('run-counter');
            if (runCounter) runCounter.style.display = 'none';
            const newsletterSection = document.querySelector('.newsletter-section');
            if(newsletterSection) newsletterSection.style.display = 'none';
        }
        
        // --- Datos de la App ---
        const heavenlyStemsData = [
            { element: "Madera"}, { element: "Madera"}, { element: "Fuego"},
            { element: "Fuego"},  { element: "Tierra"}, { element: "Tierra"},
            { element: "Metal"},  { element: "Metal"},  { element: "Agua"},
            { element: "Agua"}
        ];
        
        const elementData = {
            'Madera': {
                bgColor: '#2e8b2e',
                description: '¡Pura energía y crecimiento! Los tipo Madera son como la primavera: siempre listos para empezar algo nuevo, con una creatividad que se dispara en todas direcciones. Son líderes natos, audaces y no temen abrirse paso. A veces, su ímpetu los hace un poco tercos, como un árbol que se niega a doblarse ante el viento. ¡Cuidado con su ira, que puede surgir como una rama que se quiebra sin aviso!',
                question: 'Y tú, si tuvieras que plantar una idea nueva ahora mismo, ¿qué tan alto dejarías que creciera?',
                footerNote: '*Esta es una aproximación a tu elemento debes determinar el tipo de MADERA que eres.'
            },
            'Fuego': {
                bgColor: '#c21919',
                description: '¡La chispa de la vida! El Fuego es pasión, alegría y pura luz. Son el alma de la fiesta, carismáticos, expresivos y con un corazón que arde de entusiasmo. Aman conectar con los demás y su risa es contagiosa. Eso sí, a veces tanto calor puede llevarlos a un drama digno de telenovela o a consumirse en su propia llama si no encuentran cómo recargar su energía.',
                question: 'Si tu alegría fuera una llama, ¿qué es lo que hoy la haría brillar más intensamente?',
                footerNote: '*Es importante saber si naciste en el día o en la noche y determinar el tipo de FUEGO que eres.'
            },
            'Tierra': {
                bgColor: '#cd853f',
                description: '¡Los que tienen los pies bien puestos sobre... pues, la tierra! Este elemento es sinónimo de estabilidad, cuidado y de nutrir a los demás. Son personas confiables, prácticas y mediadoras por naturaleza, siempre buscando la armonía. Suelen ser el pilar de cualquier grupo. El detalle es que a veces pueden pensar demasiado las cosas, quedándose atascados en la preocupación como si fueran arenas movedizas.',
                question: '¿Qué es aquello que te ancla y te da estabilidad, incluso cuando todo a tu alrededor parece un torbellino?',
                footerNote: ''
            },
            'Metal': {
                bgColor: '#cbc4d1',
                description: 'Precisión, orden y un brillo particular. Los Metal son analíticos, organizados y valoran la justicia por encima de todo. Tienen una mente afilada como una espada, capaces de cortar con lo innecesario para llegar al núcleo de cualquier asunto. A veces pueden ser un poco rígidos o distantes, protegiendo sus emotions bajo una armadura reluciente. Su tristeza es profunda y silenciosa.',
                question: 'Si pudieras “editar” tu vida, ¿qué es lo que con precisión de cirujano decidirías soltar para sentirte más ligero?',
                footerNote: '*Es importante saber si naciste en el día o en la noche y determinar el tipo de METAL que eres.'
            },
            'Agua': {
                bgColor: '#38bfcc',
                description: 'Misteriosos, profundos y adaptables. El Agua fluye, se transforma y puede ser tan tranquila como un lago o tan arrolladora como un tsunami. Son personas introspectivas, sabias y con una fuerza de voluntad inmensa que corre por debajo de la superficie. Su mayor temor es el miedo mismo, y a veces pueden navegar en corrientes de incertidumbre.',
                question: 'Si tu vida fuera un río, ¿estás fluyendo con la corriente, nadando contra ella, o te tomas un momento para flotar y ver a dónde te lleva?',
                footerNote: ''
            }
        };

        // --- Elementos del DOM ---
        const calculatorScreen = document.getElementById('calculator-screen');
        const resultScreen = document.getElementById('result-screen');
        const birthDateInput = document.getElementById('birthDate');
        const calculateDayMasterButton = document.getElementById('calculateDayMaster');
        const dayMasterErrorDiv = document.getElementById('dayMasterError');
        const backButton = document.getElementById('backButton');
        
        const resultTitle = document.getElementById('result-title-element');
        const resultDescription = document.getElementById('result-description');
        const resultQuestion = document.getElementById('result-question');
        const resultFooterNote = document.getElementById('result-footer-note');
        const copyrightResultDiv = document.getElementById('copyright-result');
        const copyrightTextSpan = document.getElementById('copyright-text');
        const runCounterSpan = document.querySelector('#run-counter span');

        const newsletterForm = document.getElementById('newsletter-form');
        const newsletterEmailInput = document.getElementById('newsletter-email');
        const newsletterFeedback = document.getElementById('newsletter-feedback');
        
        const JDN_REF_KNOWN_DATE = 2446993; 
        const KNOWN_STEM_INDEX_FOR_REF_DATE = 2;

        function toJDN(year, month, day) {
            let a = Math.floor((14 - month) / 12);
            let y = year + 4800 - a;
            let m = month + 12 * a - 3;
            return day + Math.floor((153 * m + 2) / 5) + 365 * y + Math.floor(y / 4) - Math.floor(y / 100) + Math.floor(y / 400) - 32045;
        }

        // --- Lógica del Contador ---
        const counterRef = doc(db, `/artifacts/${appId}/public/data/global_metrics`, 'calculator_runs');

        async function displayCounter() {
            if (!isFirebaseReady) {
                 runCounterSpan.textContent = "N/A";
                 return;
            }
            try {
                const docSnap = await getDoc(counterRef);
                if (docSnap.exists()) {
                    runCounterSpan.textContent = docSnap.data().count;
                } else {
                    runCounterSpan.textContent = "0";
                }
            } catch(e) {
                console.error("Error al obtener contador:", e);
                runCounterSpan.textContent = "N/A";
            }
        }

        async function incrementCounter() {
            if (!isFirebaseReady) return;
            try {
                await setDoc(counterRef, { count: increment(1) }, { merge: true });
                displayCounter();
            } catch(e) {
                console.error("Error al incrementar contador:", e);
            }
        }

        // --- Event Listeners ---
        calculateDayMasterButton.addEventListener('click', async () => {
            dayMasterErrorDiv.textContent = '';

            const birthDateString = birthDateInput.value;
            if (!birthDateString) {
                dayMasterErrorDiv.textContent = 'Por favor, selecciona una fecha de nacimiento.';
                return;
            }

            const parts = birthDateString.split('-'); 
            const year = parseInt(parts[0], 10);
            const month = parseInt(parts[1], 10); 
            const day = parseInt(parts[2], 10);

            if (isNaN(year) || isNaN(month) || isNaN(day) || year < 1000) { 
                dayMasterErrorDiv.textContent = 'Fecha inválida. Asegúrate de que esté completa y sea razonable.';
                return;
            }
            
            if (isFirebaseReady) {
                await incrementCounter();
            }
            
            const jdnOfBirthDate = toJDN(year, month, day);
            const dayDifference = jdnOfBirthDate - JDN_REF_KNOWN_DATE;
            let stemIndex = (KNOWN_STEM_INDEX_FOR_REF_DATE + dayDifference) % 10;
            if (stemIndex < 0) stemIndex += 10; 

            const dayMaster = heavenlyStemsData[stemIndex];
            if (dayMaster) {
                const element = dayMaster.element;
                showResult(element);
            } else {
                 dayMasterErrorDiv.textContent = 'No se pudo calcular el Tronco Celestial para esta fecha.';
            }
        });

        backButton.addEventListener('click', (e) => {
            e.preventDefault();
            showCalculator();
        });

        newsletterForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            if (!isFirebaseReady) {
                newsletterFeedback.textContent = "Servicio de suscripción no disponible.";
                newsletterFeedback.style.color = 'red';
                return;
            }

            const email = newsletterEmailInput.value.trim();
            newsletterFeedback.textContent = 'Procesando...';
            newsletterFeedback.style.color = 'white';

            try {
                const subscribersRef = collection(db, `/artifacts/${appId}/public/data/newsletter_subscribers`);
                const q = query(subscribersRef, where("email", "==", email));
                const querySnapshot = await getDocs(q);

                if (!querySnapshot.empty) {
                    newsletterFeedback.textContent = 'Este correo ya está suscrito. ¡Gracias!';
                    newsletterFeedback.style.color = '#fde047'; // yellow
                    return;
                }
                
                await addDoc(subscribersRef, {
                    email: email,
                    subscribedAt: serverTimestamp()
                });
                
                newsletterFeedback.textContent = '¡Gracias por suscribirte!';
                newsletterFeedback.style.color = '#bef264'; // lime
                newsletterEmailInput.value = '';

            } catch (error) {
                console.error("Error al suscribirse:", error);
                newsletterFeedback.textContent = 'Ocurrió un error. Inténtalo de nuevo.';
                newsletterFeedback.style.color = 'red';
            }
        });

        // --- Funciones de control de vista ---
        function showResult(element) {
            const data = elementData[element];

            if (data) {
                resultTitle.textContent = element.toUpperCase();
                resultDescription.textContent = data.description;
                resultQuestion.textContent = data.question;
                resultFooterNote.textContent = data.footerNote;
                copyrightTextSpan.textContent = "Copyright 2025 - Marcy Bing. All rights reserved.";
                document.body.style.backgroundColor = data.bgColor;
                
                newsletterFeedback.textContent = '';
                newsletterEmailInput.value = '';

                calculatorScreen.classList.add('hidden');
                resultScreen.classList.remove('hidden');
            } else {
                dayMasterErrorDiv.textContent = 'Datos del elemento no encontrados.';
            }
        }

        function showCalculator() {
            document.body.style.backgroundColor = '';
            calculatorScreen.classList.remove('hidden');
            resultScreen.classList.add('hidden');
            birthDateInput.value = '';
        }
        
        // Cargar el contador inicial al cargar la página
        if(isFirebaseReady) {
            displayCounter();
        } else {
            const runCounter = document.getElementById('run-counter');
            if(runCounter) runCounter.style.display = 'none';
        }
    </script>
</body>
</html>
